sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/ui/model/json/JSONModel"],(e,o,t)=>{"use strict";return e.extend("com.docqa.docqaui.controller.View1",{onInit(){this.getView().setModel(new t({answer:"",highlights:[]}));this.docID=null},onFileChange:async function(e){const t=e.getParameter("files")[0];if(!t)return;const n=await this._fileToBase64(t);const s=t.name;try{const e=await fetch("/odata/v4/DocQAService/UploadDocument",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:s,content:n})});if(!e.ok)throw new Error("Upload failed");const t=await e.json();this.docID=t;o.show("PDF uploaded. Generating embeddings...");const a=await fetch("/odata/v4/DocQAService/GenerateEmbeddings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docID:this.docID})});if(!a.ok)throw new Error("Embedding failed");o.show("Embeddings generated. You can now ask a question.")}catch(e){console.error(e);o.show("Error: "+e.message)}},onAskQuestion:async function(){const e=this.byId("questionInput").getValue();if(!e||!this.docID){o.show("Please upload a PDF and enter a question.");return}try{const o=await fetch("/odata/v4/DocQAService/AskQuestion",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e,docID:this.docID})});if(!o.ok)throw new Error("Ask failed");const t=await o.json();this.getView().getModel().setData(t)}catch(e){console.error(e);o.show("Failed to get answer.")}},_fileToBase64(e){return new Promise((o,t)=>{const n=new FileReader;n.onload=()=>{const e=n.result.split(",")[1];o(e)};n.onerror=t;n.readAsDataURL(e)})}})});
//# sourceMappingURL=View1.controller.js.map